

<body>
  <section class="">
    
      <div class="accordion mx-5" id="accordionExample">
        <div class="accordion-item">
          <h4 class="accordion-header">
            <button class="accordion-button fs-4 text" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Ajout Demande
            </button>
          </h4>
          <div id="collapseOne" class="accordion-collapse collapse show " data-bs-parent="#accordionExample">
            <div class="accordion-body">
                <div class="col-sm-12 col-lg-3 offset-lg-1" style="width: 80%;">
                 
                  <form class="needs-validation mb-5" novalidate>
                  <div class="row">
                      <div class="col-md-6">
                     
                          <div class="col-sm-4 col-md-6 mb-3">
                            <div class="mb-4">
                        
                              <label for="email" id="emailLabel" class="form-label">Régularisation<span class="visually-hidden"> (required)</span></label>
                              <div class="form-check form-switch">
                                <input class="form-check-input" [(ngModel)]="this.demande.estregularisation" name="estRegularisation" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                              </div> 
                            </div>
                          
                            <!-- <div class="mb-3">
                              <label for="email" id="emailLabel" class="form-label is-required">Date de creation<span class="visually-hidden"> (required)</span></label>
                              <span  class="form-control"  id="lastName" aria-labelledby="lastNameLabel lastNameFeedback" autocomplete="family-name" required>{{this.demande.dateCreation}}</span>
                              
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="emailFeedback" class="invalid-feedback">
                                date vide.
                              </div>
                            </div> -->
                          <!-- <span class="text-primary me-1">*</span>indicates required -->
                          <label for="selectTitle" id="selectTitleLabel" class="form-label ">Titre<span class="visually-hidden"> (required)</span></label>
                          <div class="input-group mb-2">
                            <select class="form-select" [(ngModel)]="this.demande.idTitreDepense" name="idTitreDepense" id="idtitre" aria-label="Liste déroulante des titres de dépenses">
                              <option *ngFor="let titre of titres" [value]="titre.id">{{ titre.designation }}</option>
                          </select>
        
                            <button
                              class="btn btn-outline-secondary"
                              data-bs-toggle="modal"
                              data-bs-target="#exampleModal"
                              data-bs-whatever="@mdo"
                            >
                              +
                            </button>
                          </div>
                         
                            <div class="valid-feedback">
                              Bien!
                            </div>
                            <div id="selectTitleFeedback" class="invalid-feedback">
                              titre vide.
                            </div>


                            
                            
                          </div>
                          
                          <div class="col-12">
                            <div class="mb-3">
                              <label for="email" id="emailLabel" class="form-label is-required">Type<span class="visually-hidden"> (required)</span></label>
                             <div class="d-flex ">
                                  <select class="form-select" id="country" (ngModelChange)="refencedemande()" [(ngModel)]="this.demande.typeReference" name="typeReference" aria-labelledby="countryLabel countryFeedback" autocomplete="country-name" required>
                                    <!-- <option selected disabled value="" aria-hidden="true">Select a country</option> -->
                                    <option value="BC">Reference BC</option>
                                    <option value="DED">Reference DED</option>
                                  </select>
                                  <!-- <div *ngIf="nomrefence===true"> -->
                                    <input
                                    type="text"
                                    step="any"
                                    [(ngModel)]="this.demande.nomReference"
                                    class="form-control mx-2" name="nomrefence"
                                    value="{{ this.demande.typeReference }}-"
                                    aria-label=""
                                    aria-describedby="basic-addon1"
                                  />
                              <!-- </div> -->
                             </div>
                              
                              <div class="valid-feedback">
                              Bien!
                              </div>
                              <div id="firstNameFeedback" class="invalid-feedback">
                                selectionnez une type de reference.
                              </div>
                            </div>
                            
                            <div class="mb-3">
                              <label for="firstName" id="firstNameLabel" class="form-label is-required">OPEX/CAPEX<span class="visually-hidden"> (required)</span></label>
                              <select class="form-select" id="country" [(ngModel)]="this.demande.depense" name="depense" aria-labelledby="countryLabel countryFeedback" autocomplete="country-name" required>
                                  <!-- <option selected disabled value="" aria-hidden="true">Select a country</option> -->
                                  <option value="OPEX">OPEX</option>
                                  <option value="CAPEX">CAPEX</option>
                                </select>
                                <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="firstNameFeedback" class="invalid-feedback">
                                selectionnez opex ou capex .
                              </div>
                            </div>
                           
                            <div class="mb-3">
                              <label for="email" id="emailLabel" class="form-label is-required">Devise<span class="visually-hidden"> (required)</span></label>
                              <select class="form-select" id="country" [(ngModel)]="this.demande.typeDevise" name="devise" aria-labelledby="countryLabel countryFeedback" autocomplete="country-name" required>
                                  <!-- <option selected disabled value="" aria-hidden="true">Select a country</option> -->
                                  <option value="MGA">MGA</option>
                                  <option value="USD">USD</option>
                                  <option value="EUR">EUR</option>
          
                                </select>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="emailFeedback" class="invalid-feedback">
                                Selectionnez le devise.
                              </div>
                            </div>
                            <div class="mb-3">
                              <label for="country" id="countryLabel" class="form-label is-required">Rubrique<span class="visually-hidden"> (required)</span></label>
                              <select class="form-select" [(ngModel)]="this.demande.idRubrique" name="idrubrique" aria-labelledby="countryLabel countryFeedback" autocomplete="country-name" required>
                                <option
                                    *ngFor="let item of this.rubriques"
                                    [value]="item.id"
                                  >
                                    {{ item.designation }}
                                </option>
                              </select>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="countryFeedback" class="invalid-feedback">
                                selectionnez le rubrique.
                              </div>
                            </div>
                            <div class="mb-3">
                              <label for="message" id="messageLabel" class="form-label is-required">Motif besoin<span class="visually-hidden"> (required)</span></label>
                           
                              <textarea class="form-control" id="message"[(ngModel)]="this.demande.motif" name="motif" rows="5"  aria-labelledby="messageLabel messageFeedback" required></textarea>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="messageFeedback" class="invalid-feedback">
                                  Motif vide.
                              </div>
                              
                            </div>

                            <div class="mb-3">
                              <button type="button" class="btn btn-outline-secondary mx-3" (click)="precedent()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="solaris-icon si-form-chevron-left" viewBox="0 0 1000 1000">
                                  <path d="M604.5 208 396.286 416.214 313 499.5l83.286 83.286L604.5 791l83.286-83.286L479.57 499.5l208.215-208.214z"/>
                                </svg>
                              </button>
                            </div>
                          </div>
                        </div>
          
                        <div class="col-md-6">
                         
                          <div class="col-sm-4 col-md-6 mb-4">
                        
                            
                              <label for="email" id="emailLabel" class="form-label">Date de creation<span class="visually-hidden"> (required)</span></label>
                              <span  class="form-control"  id="lastName" aria-labelledby="lastNameLabel lastNameFeedback" autocomplete="family-name" required>{{this.demande.dateCreation}}</span>
                              
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="emailFeedback" class="invalid-feedback">
                                date vide.
                              </div>
                            </div>
                              <div class="mb-3">
                              <label for="email" id="emailLabel" class="form-label is-required">Direction<span class="visually-hidden"> (required)</span></label>
                                <select
                                  class="form-select"
                                  id="inputGroupSelect04"aria-labelledby="countryLabel countryFeedback" autocomplete="country-name" required
                                >
                                <option selected>{{this.departement}}</option>
                                  <!-- <option
                                    *ngFor="let item of this.periodes"
                                    [value]="item.id"
                                  >
                                    {{ item.designation }}
                                  </option> -->
                            </select>
                            <div class="valid-feedback">
                              Bien!
                            </div>
                            <div id="emailFeedback" class="invalid-feedback">
                              Periode vide.
                            </div>
                          </div>
                          <div class="col-12">
                            <div class="mb-3">
                              <label for="firstName" id="firstNameLabel" class="form-label ">Fournisseur(s)<span class="visually-hidden"> (required)</span></label>
                              <input type="text" class="form-control"[(ngModel)]="this.demande.fournisseur" name="fournisseur" id="firstName" aria-labelledby="firstNameLabel firstNameFeedback" autocomplete="given-name" required>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="firstNameFeedback" class="invalid-feedback">
                                Fournisseurs vide.
                              </div>
                            </div>
                            <div class="mb-3">
                              <label for="lastName" id="lastNameLabel" class="form-label is-required">Montant HT<span class="visually-hidden"> (required)</span></label>
                              <input type="number" class="form-control"[(ngModel)]="this.demande.montantHt" name="montantHt"id="lastName" aria-labelledby="lastNameLabel lastNameFeedback" autocomplete="family-name" required>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="lastNameFeedback" class="invalid-feedback">
                                MontantHt vide.
                              </div>
                            </div>
                            <div class="mb-3">
                              <label for="email" id="emailLabel" class="form-label is-required">Période<span class="visually-hidden"> (required)</span></label>
                              <select
                                    class="form-select"
                                    [(ngModel)]="this.demande.idPeriode" name="idPeriode"
                                    id="inputGroupSelect04"aria-labelledby="countryLabel countryFeedback" autocomplete="country-name" required
                                  >
                                    <option
                                      *ngFor="let item of this.periodes"
                                      [value]="item.id"
                                    >
                                      {{ item.designation }}
                                    </option>
                              </select>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="emailFeedback" class="invalid-feedback">
                                Periode vide.
                              </div>
                            </div>
                            <div class="mb-3">
                              <label for="country" id="countryLabel" class="form-label">Sous rubrique<span class="visually-hidden"> (required)</span></label>
                              <input type="text" class="form-control" name="sousRubrique" [(ngModel)]="this.demande.sousRubrique" id="lastName" aria-labelledby="lastNameLabel lastNameFeedback" autocomplete="family-name" required>
                              
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="countryFeedback" class="invalid-feedback">
                                sous Rubrique vide.
                              </div>
                            </div>
                          
                            
                            <div class="mb-3">
                              
                              <label for="message" id="messageLabel" class="form-label">Commentaire<span class="visually-hidden"> (required)</span></label>
                              
                              <textarea class="form-control" id="message" name="comsPrescripteur" [(ngModel)]="this.demande.comsPrescripteur" rows="5"  aria-labelledby="messageLabel messageFeedback" required></textarea>
                              <div class="valid-feedback">
                                Bien!
                              </div>
                              <div id="messageFeedback" class="invalid-feedback">
                                commentaire vide.
                              </div>
                            </div>
                            <div class="mb-3">
                              <div *ngIf="this.alert===true" class="alert alert-success z-3 bg-white border-success "style="width:300px; " role="alert">
                                <span class="alert-icon"><span class="visually-hidden">Success</span></span>
                                <p>{{ errorMessage }}</p>
                              </div>
                              <div class="bt p-3 d-flex justify-content-end">
                                <div class="error-message">
                                  
                                  <p class="text-success">{{ errorMessage }}</p>
                                </div>
                              </div>
                            </div>
                            <!-- <button (click)="test()">test</button> -->
                           <div class="mb-3 d-flex justify-content-end">
                            <button
                              type="button"
                              class="btn z-1 btn-primary "
                              (click)="creerDemande()"
                            >
                              Enregistrer 
                            </button>
              <button type="submit" class="btn btn-primary mt-2">Submit</button>

                           </div>
                          </div>
                        </div>
                  </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
     
      
    
  </section>
</body>

<!--POP UP TITRTE-->
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title h5" id="exampleModalLabel">Titre</h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          data-bs-toggle="tooltip"
          data-bs-placement="bottom"
          data-bs-title="Close"
        >
          <span class="visually-hidden">Close</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label"
              >Ajout titre:</label
            >
            <input
              type="text"
              class="form-control"
              [(ngModel)]="TitreDepense.designation"
              [ngModelOptions]="{ standalone: true }" name="designation"
              id="recipient-name"
            />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-primary"
          (click)="Ajouttitre()"
          data-bs-dismiss="modal"
        >
          Enregistrer
        </button>
      </div>
    </div>
  </div>
</div>
<script>
  (() => {
  'use strict'

  // Tooltip
  const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
  const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new boosted.Tooltip(tooltipTriggerEl)) // eslint-disable-line no-unused-vars, no-undef

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  const forms = document.querySelectorAll('.needs-validation')
  // Loop over them and prevent submission
  Array.from(forms).forEach(form => {
    form.addEventListener('submit', event => {
      console.log(event,'rrttrttt');
      if (!form.checkValidity()) {
        event.preventDefault()
        event.stopPropagation()
        // Focus on first error
        const invalidItems = form.querySelectorAll(':invalid')
        invalidItems[0].focus()
        invalidItems[0].setAttribute('data-focus-visible-added', '')
      }

      form.classList.add('was-validated')
    })
  })
})()

</script>